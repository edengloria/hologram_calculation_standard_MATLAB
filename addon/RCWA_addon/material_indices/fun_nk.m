function nk=fun_nk(lambda,matname,method)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%   nk values of dielectric & metal
%%%      - dielectric: BK7, F2, SF10, FS
%%%      - metal: Ag, Al, Au, Cr, Cu, Pt
%%%      - last updated: 2008-10-21 (Ver. 1.00), Seyoon Kim
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% n+jk=fun_nk(lambda,matname,method)
%    - lambda: wavelength[m], it can be 1D array
%    - matname: material name (see under)
%    - method: database of metal, default method is SOPRA (see under)
%    * material name and method can be either uppercase or lowercase 
%    Ex) n=fun_nk(532*nm,'FS');
%        n+jk=fun_nk(532*nm,'Ag');
%        n+jk=fun_nk(532*nm,'Pt','sopra');
%        n+jk=fun_nk(532*nm,'Au','palik');
%        n+jk=fun_nk([200:1:300]*nm,'Cu','j&c');
%
% [dielectric]
%    - matname: BK7(400nm ~ 2010nm),  F2(400nm ~ 2010nm),
%               SF10(400nm ~ 2010nm), FS(400nm ~ 2010nm)
%    - data source: Br. Yongjun's data
%
% [metal: SOPRA]
%    - matname: Ag(188nm ~ 2066nm), Al(184nm ~ 2479nm),
%               Au(207nm ~ 2479nm), Cr(207nm ~ 1239nm),
%               Cu(191nm ~ 2479nm), Pt(207nm ~ 2479nm)
%    - data source: http://www.sopra-sa.com
%
% [metal: Palik]
%    - matname: Ag(200nm ~ 2000nm), Au(200nm ~ 2000nm)
%    - data source: Handbook of Optical Constants of Solids,
%                   E. D. Palik (Academic, SanDiego, 1998)
%
% [metal: J&C]
%    - matname: Ag(188nm ~ 1937nm), Au(188nm ~ 1937nm), 
%               Cu(188nm ~ 1937nm)
%    - data source: P. B. Johnson and R. W. Christy, "Optical Constants
%                   of the Noble Metals,"Phys. Rev. B 6, 4370 (1972)



%%% basic parameter %%%
bp.c0=2.997924580*10^8;
bp.h=4.13566733*10^-15;
bp.nm=10^-9;



%%% check material name & method %%%
switch lower(matname)
    % dielectric
    case {'bk7','f2','sf10','fs'}
        [lset nset kset]=fun_nk_dielectric(bp,matname);
        
    % metal
    case {'ag', 'al', 'au', 'cr', 'cu', 'pt'}
        if nargin==2
            method='sopra';   % default metal method
        end
        
        switch lower(method);
            case 'sopra';   [lset nset kset]=fun_nk_sopra(bp,matname);
            case 'palik';   [lset nset kset]=fun_nk_palik(bp,matname);
            case 'j&c'  ;   [lset nset kset]=fun_nk_jnc(bp,matname);
            otherwise   ;   error('Invalid method');
        end
        
    otherwise
        error('Invalid material');
end



%%% check lambda range %%%
min_lambda=min(lset);
max_lambda=max(lset);
if (min(lambda)<min_lambda)||(max(lambda)>max_lambda)
    error(['Capable lambda range of ',upper(matname),' is between ',...
            num2str(min_lambda/bp.nm),'nm and ',num2str(max_lambda/bp.nm),'nm in ',...
            upper(method),' method']);
end



%%% nk value %%%
nv=spline(lset,nset,lambda);
kv=spline(lset,kset,lambda);
nk=nv+j*kv;



function [lset nset kset]=fun_nk_dielectric(bp,matname)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%   nk values of dielectric
%%%      - data source: Br. Yongjun's data
%%%      - matname: 'BK7','F2','SF10','FS'
%%%      - last updated: 2008. 10. 21. (Ver 1.0), Seyoon Kim
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% dielectric data %%%
data_dielectric=[400	1.53085 	1.65215 	1.77826 	1.47012 	;     
                 442	1.52611 	1.64058 	1.75970 	1.46622 	;
                 458	1.52461 	1.63716 	1.75434 	1.46498 	;    
                 488	1.52224 	1.63178 	1.74602 	1.46301 	;
                 515	1.52049 	1.62784 	1.73999 	1.46156 	;     
                 532	1.51947 	1.62569 	1.73673 	1.46071 	;
                 590	1.51670 	1.61983 	1.72794 	1.45838 	;     
                 633	1.51509 	1.61654 	1.72307 	1.45702 	;
                 670	1.51391 	1.61421 	1.71965 	1.45601 	;     
                 694	1.51322 	1.61290 	1.71773 	1.45542 	;
                 755	1.51172 	1.61009 	1.71367 	1.45414 	;     
                 780	1.51118 	1.60911 	1.71227 	1.45367 	;
                 800	1.51078 	1.60839 	1.71124 	1.45332 	;     
                 820	1.51039 	1.60771 	1.71028 	1.45298 	;
                 860	1.50966 	1.60648 	1.70854 	1.45234 	;     
                 980	1.50779 	1.60349 	1.70441 	1.45067 	;
                 1064	1.50663 	1.60183 	1.70217 	1.44963 	;     
                 1320	1.50346 	1.59785 	1.69706 	1.44669 	;
                 1550	1.50065 	1.59487 	1.69348 	1.44402 	;     
                 2010	1.49435 	1.58905 	1.68693 	1.43794    ];



%%% check matname %%%
lmatname=lower(matname);
switch lmatname
    case 'bk7';   nset=data_dielectric(:,2);
    case 'f2';    nset=data_dielectric(:,3);
    case 'sf10';  nset=data_dielectric(:,4);
    case 'fs';    nset=data_dielectric(:,5);
end
lset=data_dielectric(:,1)*bp.nm;
kset=zeros(size(lset));



function [lset nset kset]=fun_nk_sopra(bp,matname)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%   nk values of metal - SOPRA
%%%      - data source: http://www.sopra-sa.com
%%%      - matname: 'Ag', 'Al', 'Au', 'Cr', 'Cu', 'Pt'
%%%      - last updated: 2008. 10. 21. (Ver 1.0), Seyoon Kim
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% metal data %%%
data_Ag=[0.60 	1.064000 	14.400000 	;    0.65 	0.987875 	13.155000 	;    0.70 	0.844000 	12.200000 	;    0.75 	0.672625 	11.445000 	;
        0.80 	0.514000 	10.800000 	;    0.85 	0.438563 	10.114370 	;    0.90 	0.396000 	9.480000 	;    0.95 	0.360000 	8.953750 	;
        1.00 	0.329000 	8.490000 	;    1.05 	0.287375 	8.060625 	;    1.10 	0.251000 	7.670000 	;    1.15 	0.235375 	7.313750 	;
        1.20 	0.226000 	6.990000 	;    1.25 	0.212625 	6.697500 	;    1.30 	0.198000 	6.430000 	;    1.35 	0.179875 	6.183125 	;
        1.40 	0.163000 	5.950000 	;    1.45 	0.151938 	5.720624 	;    1.50 	0.145000 	5.500000 	;    1.55 	0.142563 	5.288750 	;
        1.60 	0.143000 	5.090000 	;    1.65 	0.145875 	4.908125 	;    1.70 	0.148000 	4.740000 	;    1.75 	0.144313 	4.586250 	;
        1.80 	0.140000 	4.440000 	;    1.85 	0.140063 	4.293125 	;    1.90 	0.140000 	4.150000 	;    1.95 	0.136125 	4.010625 	;
        2.00 	0.131000 	3.880000 	;    2.05 	0.125500 	3.766250 	;    2.10 	0.121000 	3.660000 	;    2.15 	0.119313 	3.553750 	;
        2.20 	0.120000 	3.450000 	;    2.25 	0.124375 	3.348125 	;    2.30 	0.129000 	3.250000 	;    2.35 	0.130063 	3.159375 	;
        2.40 	0.130000 	3.070000 	;    2.45 	0.129938 	2.973750 	;    2.50 	0.130000 	2.880000 	;    2.55 	0.130250 	2.798125 	;
        2.60 	0.132000 	2.720000 	;    2.65 	0.137313 	2.640000 	;    2.70 	0.144000 	2.560000 	;    2.75 	0.151063 	2.478750 	;
        2.80 	0.157000 	2.400000 	;    2.85 	0.158500 	2.329375 	;    2.90 	0.160000 	2.260000 	;    2.95 	0.166688 	2.186250 	;
        3.00 	0.173000 	2.110000 	;    3.05 	0.172625 	2.029375 	;    3.10 	0.173000 	1.950000 	;    3.15 	0.182000 	1.878750 	;
        3.20 	0.192000 	1.810000 	;    3.25 	0.198063 	1.735000 	;    3.30 	0.200000 	1.670000 	;    3.35 	0.192063 	1.641875 	;
        3.40 	0.186000 	1.610000 	;    3.45 	0.194813 	1.533750 	;    3.50 	0.209000 	1.440000 	;    3.55 	0.221438 	1.345250 	;
        3.60 	0.238000 	1.240000 	;    3.65 	0.253313 	1.120687 	;    3.70 	0.294000 	0.986000 	;    3.75 	0.388125 	0.818563 	;
        3.80 	0.526000 	0.663000 	;    3.85 	0.719062 	0.554375 	;    3.90 	0.932000 	0.504000 	;    3.95 	1.142062 	0.550875 	;
        4.00 	1.323000 	0.647000 	;    4.05 	1.432500 	0.761063 	;    4.10 	1.496000 	0.882000 	;    4.15 	1.519375 	0.988813 	;
        4.20 	1.519000 	1.080000 	;    4.25 	1.513563 	1.143000 	;    4.30 	1.502000 	1.190000 	;    4.35 	1.490125 	1.228750 	;
        4.40 	1.476000 	1.260000 	;    4.45 	1.459188 	1.288125 	;    4.50 	1.441000 	1.310000 	;    4.55 	1.422312 	1.321875 	;
        4.60 	1.404000 	1.330000 	;    4.65 	1.387500 	1.341250 	;    4.70 	1.372000 	1.350000 	;    4.75 	1.356938 	1.351250 	;
        4.80 	1.343000 	1.350000 	;    4.85 	1.331063 	1.350000 	;    4.90 	1.320000 	1.350000 	;    4.95 	1.308563 	1.350625 	;
        5.00 	1.298000 	1.350000 	;    5.05 	1.289687 	1.345625 	;    5.10 	1.282000 	1.340000 	;    5.15 	1.273437 	1.335000 	;
        5.20 	1.265000 	1.330000 	;    5.25 	1.257188 	1.325000 	;    5.30 	1.250000 	1.320000 	;    5.35 	1.244000 	1.314687 	;
        5.40 	1.238000 	1.310000 	;    5.45 	1.230688 	1.307187 	;    5.50 	1.223000 	1.305000 	;    5.55 	1.215688 	1.302500 	;
        5.60 	1.208000 	1.300000 	;    5.65 	1.199125 	1.297500 	;    5.70 	1.190000 	1.295000 	;    5.75 	1.181875 	1.292813 	;
        5.80 	1.173000 	1.290000 	;    5.85 	1.161438 	1.285312 	;    5.90 	1.149000 	1.280000 	;    5.95 	1.137188 	1.275000 	;
        6.00 	1.125000 	1.270000 	;    6.05 	1.111625 	1.265625 	;    6.10 	1.098000 	1.260000 	;    6.15 	1.084812 	1.251250 	;
        6.20 	1.072000 	1.240000 	;    6.25 	1.059625 	1.225625 	;    6.30 	1.048000 	1.210000 	;    6.35 	1.037500 	1.194375 	;
        6.40 	1.028000 	1.180000 	;    6.45 	1.019500 	1.168125 	;    6.50 	1.012000 	1.160000 	;    6.55 	1.004250 	1.149375 	;
        6.60 	0.995000 	1.130000   ];


data_Al=[0.50 	3.070000 	25.600000 	;    0.55 	2.620000 	23.300000 	;    0.60 	2.270000 	21.400000 	;    0.65 	1.990000 	19.800000 	;
        0.70 	1.770000 	18.300000 	;    0.75 	1.590000 	17.100000 	;    0.80 	1.440000 	16.000000 	;    0.85 	1.330000 	14.900000 	;
        0.90 	1.260000 	14.000000 	;    0.95 	1.230000 	13.200000 	;    1.00 	1.210000 	12.500000 	;    1.05 	1.210000 	11.800000 	;
        1.10 	1.200000 	11.200000 	;    1.15 	1.210000 	10.600000 	;    1.20 	1.260000 	10.000000 	;    1.25 	1.370000 	9.490000 	;
        1.30 	1.470000 	8.950000 	;    1.35 	1.860000 	8.440000 	;    1.40 	2.240000 	8.210000 	;    1.45 	2.580000 	8.210000 	;
        1.50 	2.740000 	8.310000 	;    1.55 	2.800000 	8.450000 	;    1.60 	2.630000 	8.600000 	;    1.65 	2.410000 	8.620000 	;
        1.70 	2.140000 	8.570000 	;    1.75 	1.910000 	8.390000 	;    1.80 	1.740000 	8.210000 	;    1.85 	1.600000 	8.010000 	;
        1.90 	1.490000 	7.820000 	;    1.95 	1.390000 	7.650000 	;    2.00 	1.300000 	7.480000 	;    2.05 	1.220000 	7.310000 	;
        2.10 	1.150000 	7.150000 	;    2.15 	1.080000 	7.000000 	;    2.20 	1.020000 	6.850000 	;    2.25 	0.963000 	6.700000 	;
        2.30 	0.912000 	6.550000 	;    2.35 	0.867000 	6.420000 	;    2.40 	0.826000 	6.280000 	;    2.45 	0.789000 	6.150000 	;
        2.50 	0.755000 	6.030000 	;    2.55 	0.723750 	5.915000 	;    2.60 	0.695000 	5.800000 	;    2.65 	0.668625 	5.690000 	;
        2.70 	0.644000 	5.580000 	;    2.75 	0.620313 	5.480000 	;    2.80 	0.598000 	5.380000 	;    2.85 	0.577313 	5.290000 	;
        2.90 	0.558000 	5.200000 	;    2.95 	0.540063 	5.108750 	;    3.00 	0.523000 	5.020000 	;    3.05 	0.506188 	4.938125 	;
        3.10 	0.490000 	4.860000 	;    3.15 	0.474688 	4.784375 	;    3.20 	0.460000 	4.710000 	;    3.25 	0.445688 	4.633750 	;
        3.30 	0.432000 	4.560000 	;    3.35 	0.419125 	4.493750 	;    3.40 	0.407000 	4.430000 	;    3.45 	0.395750 	4.365000 	;
        3.50 	0.385000 	4.300000 	;    3.55 	0.374375 	4.233750 	;    3.60 	0.364000 	4.170000 	;    3.65 	0.353813 	4.113750 	;
        3.70 	0.344000 	4.060000 	;    3.75 	0.334750 	4.005000 	;    3.80 	0.326000 	3.950000 	;    3.85 	0.317875 	3.894375 	;
        3.90 	0.310000 	3.840000 	;    3.95 	0.301875 	3.789375 	;    4.00 	0.294000 	3.740000 	;    4.05 	0.286813 	3.689375 	;
        4.10 	0.280000 	3.640000 	;    4.15 	0.273375 	3.593750 	;    4.20 	0.267000 	3.550000 	;    4.25 	0.260875 	3.510000 	;
        4.30 	0.255000 	3.470000 	;    4.35 	0.249438 	3.425000 	;    4.40 	0.244000 	3.380000 	;    4.45 	0.238438 	3.339375 	;
        4.50 	0.233000 	3.300000 	;    4.55 	0.227938 	3.259375 	;    4.60 	0.223000 	3.220000 	;    4.65 	0.217875 	3.185000 	;
        4.70 	0.213000 	3.150000 	;    4.75 	0.208875 	3.109375 	;    4.80 	0.205000 	3.070000 	;    4.85 	0.200938 	3.039375 	;
        4.90 	0.197000 	3.010000 	;    4.95 	0.193438 	2.975000 	;    5.00 	0.190000 	2.940000 	;    5.05 	0.186500 	2.909375 	;
        5.10 	0.183000 	2.880000 	;    5.15 	0.179563 	2.850000 	;    5.20 	0.176000 	2.820000 	;    5.25 	0.171938 	2.790000 	;
        5.30 	0.168000 	2.760000 	;    5.35 	0.164938 	2.730000 	;    5.40 	0.162000 	2.700000 	;    5.45 	0.158500 	2.669375 	;
        5.50 	0.155000 	2.640000 	;    5.55 	0.151875 	2.615000 	;    5.60 	0.149000 	2.590000 	;    5.65 	0.146438 	2.559375 	;
        5.70 	0.144000 	2.530000 	;    5.75 	0.141500 	2.509375 	;    5.80 	0.139000 	2.490000 	;    5.85 	0.136438 	2.465625 	;
        5.90 	0.134000 	2.440000 	;    5.95 	0.131813 	2.414375 	;    6.00 	0.130000 	2.390000 	;    6.05 	0.127982 	2.366705 	;
        6.10 	0.125816 	2.344273 	;    6.15 	0.123559 	2.322489 	;    6.20 	0.121268 	2.301136 	;    6.25 	0.119000 	2.280000 	;
        6.30 	0.116812 	2.258863 	;    6.35 	0.114761 	2.237511 	;    6.40 	0.112904 	2.215727 	;    6.45 	0.111298 	2.193295 	;
        6.50 	0.110000 	2.170000 	;    6.55 	0.108835 	2.146683 	;    6.60 	0.107628 	2.124184 	;    6.65 	0.106203 	2.103344 	;
        6.70 	0.104385 	2.085002 	;    6.75 	0.102000 	2.070000   ];


data_Au=[0.50 	1.205000 	15.500000 	;    0.55 	1.034000 	14.144380 	;    0.60 	0.896000 	13.000000 	;    0.65 	0.785250 	12.030630 	;
        0.70 	0.696000 	11.200000 	;    0.75 	0.621563 	10.457500 	;    0.80 	0.559000 	9.810000 	;    0.85 	0.503063 	9.203125 	;
        0.90 	0.454000 	8.770000 	;    0.95 	0.410188 	8.757501 	;    1.00 	0.372000 	8.770000 	;    1.05 	0.339375 	8.403750 	;
        1.10 	0.312000 	7.930000 	;    1.15 	0.290500 	7.485001 	;    1.20 	0.272000 	7.070000 	;    1.25 	0.253125 	6.753125 	;
        1.30 	0.236000 	6.470000 	;    1.35 	0.222125 	6.168125 	;    1.40 	0.210000 	5.880000 	;    1.45 	0.198125 	5.631250 	;
        1.50 	0.188000 	5.390000 	;    1.55 	0.181375 	5.125813 	;    1.60 	0.176000 	4.860000 	;    1.65 	0.169500 	4.610188 	;
        1.70 	0.164000 	4.357000 	;    1.75 	0.160875 	4.087687 	;    1.80 	0.160000 	3.800000 	;    1.85 	0.161000 	3.445812 	;
        1.90 	0.166000 	3.150000 	;    1.95 	0.177750 	3.070000 	;    2.00 	0.194000 	3.060000 	;    2.05 	0.212375 	3.015000 	;
        2.10 	0.236000 	2.970000 	;    2.15 	0.267625 	2.940625 	;    2.20 	0.306000 	2.880000 	;    2.25 	0.345500 	2.730625 	;
        2.30 	0.402000 	2.540000 	;    2.35 	0.491750 	2.326250 	;    2.40 	0.608000 	2.120000 	;    2.45 	0.754500 	1.956500 	;
        2.50 	0.916000 	1.840000 	;    2.55 	1.086750 	1.797375 	;    2.60 	1.242000 	1.796000 	;    2.65 	1.345875 	1.814625 	;
        2.70 	1.426000 	1.846000 	;    2.75 	1.502125 	1.875875 	;    2.80 	1.562000 	1.904000 	;    2.85 	1.596250 	1.924500 	;
        2.90 	1.616000 	1.940000 	;    2.95 	1.628000 	1.951375 	;    3.00 	1.636000 	1.958000 	;    3.05 	1.647250 	1.959375 	;
        3.10 	1.658000 	1.956000 	;    3.15 	1.666000 	1.947750 	;    3.20 	1.674000 	1.936000 	;    3.25 	1.684750 	1.922500 	;
        3.30 	1.696000 	1.906000 	;    3.35 	1.705875 	1.883000 	;    3.40 	1.716000 	1.862000 	;    3.45 	1.727625 	1.852375 	;
        3.50 	1.740000 	1.848000 	;    3.55 	1.752500 	1.845250 	;    3.60 	1.766000 	1.846000 	;    3.65 	1.782000 	1.851750 	;
        3.70 	1.798000 	1.860000 	;    3.75 	1.812000 	1.868250 	;    3.80 	1.824000 	1.878000 	;    3.85 	1.834250 	1.891375 	;
        3.90 	1.840000 	1.904000 	;    3.95 	1.837125 	1.911375 	;    4.00 	1.830000 	1.916000 	;    4.05 	1.822625 	1.918875 	;
        4.10 	1.812000 	1.920000 	;    4.15 	1.795000 	1.920375 	;    4.20 	1.776000 	1.918000 	;    4.25 	1.760000 	1.910000 	;
        4.30 	1.742000 	1.900000 	;    4.35 	1.716500 	1.891750 	;    4.40 	1.690000 	1.882000 	;    4.45 	1.668875 	1.867750 	;
        4.50 	1.648000 	1.852000 	;    4.55 	1.623625 	1.837500 	;    4.60 	1.598000 	1.822000 	;    4.65 	1.571500 	1.803375 	;
        4.70 	1.546000 	1.784000 	;    4.75 	1.522625 	1.766750 	;    4.80 	1.504000 	1.748000 	;    4.85 	1.494750 	1.724625 	;
        4.90 	1.490000 	1.698000 	;    4.95 	1.486500 	1.666750 	;    5.00 	1.484000 	1.636000 	;    5.05 	1.481125 	1.611625 	;
        5.10 	1.478000 	1.590000 	;    5.15 	1.474125 	1.569625 	;    5.20 	1.470000 	1.550000 	;    5.25 	1.466000 	1.529500 	;
        5.30 	1.462000 	1.510000 	;    5.35 	1.457625 	1.493750 	;    5.40 	1.454000 	1.478000 	;    5.45 	1.453125 	1.459500 	;
        5.50 	1.452000 	1.442000 	;    5.55 	1.447125 	1.429625 	;    5.60 	1.442000 	1.418000 	;    5.65 	1.439750 	1.403000 	;
        5.70 	1.438000 	1.388000 	;    5.75 	1.434875 	1.376000 	;    5.80 	1.432000 	1.364000 	;    5.85 	1.431125 	1.349250 	;
        5.90 	1.430000 	1.334000 	;    5.95 	1.427375 	1.319250 	;    6.00 	1.422000 	1.306000   ];


data_Cr=[1.00 	3.680000 	3.620000 	;    1.05 	3.660625 	3.591250 	;    1.10 	3.620000 	3.580000 	;    1.15 	3.564375 	3.578750 	;
        1.20 	3.500000 	3.580000 	;    1.25 	3.432500 	3.572500 	;    1.30 	3.370000 	3.560000 	;    1.35 	3.326875 	3.541250 	;
        1.40 	3.290000 	3.520000 	;    1.45 	3.251250 	3.500000 	;    1.50 	3.210000 	3.480000 	;    1.55 	3.158125 	3.460000 	;
        1.60 	3.110000 	3.440000 	;    1.65 	3.078750 	3.419375 	;    1.70 	3.060000 	3.400000 	;    1.75 	3.054375 	3.385000 	;
        1.80 	3.060000 	3.370000 	;    1.85 	3.076250 	3.350000 	;    1.90 	3.100000 	3.330000 	;    1.95 	3.129375 	3.312500 	;
        2.00 	3.160000 	3.300000 	;    2.05 	3.188125 	3.296875 	;    2.10 	3.210000 	3.300000 	;    2.15 	3.225000 	3.309375 	;
        2.20 	3.220000 	3.320000 	;    2.25 	3.178125 	3.326250 	;    2.30 	3.110000 	3.330000 	;    2.35 	3.013125 	3.332500 	;
        2.40 	2.910000 	3.330000 	;    2.45 	2.829375 	3.317500 	;    2.50 	2.750000 	3.300000 	;    2.55 	2.655000 	3.283125 	;
        2.60 	2.560000 	3.260000 	;    2.65 	2.476250 	3.222500 	;    2.70 	2.400000 	3.180000 	;    2.75 	2.331250 	3.140000 	;
        2.80 	2.270000 	3.100000 	;    2.85 	2.217500 	3.060625 	;    2.90 	2.170000 	3.020000 	;    2.95 	2.123125 	2.975000 	;
        3.00 	2.080000 	2.930000 	;    3.05 	2.043125 	2.889375 	;    3.10 	2.010000 	2.850000 	;    3.15 	1.978750 	2.808125 	;
        3.20 	1.950000 	2.770000 	;    3.25 	1.923750 	2.742500 	;    3.30 	1.900000 	2.720000 	;    3.35 	1.878125 	2.699375 	;
        3.40 	1.860000 	2.680000 	;    3.45 	1.851875 	2.660625 	;    3.50 	1.840000 	2.640000 	;    3.55 	1.807500 	2.615000 	;
        3.60 	1.770000 	2.590000 	;    3.65 	1.738125 	2.570000 	;    3.70 	1.710000 	2.550000 	;    3.75 	1.688750 	2.525625 	;
        3.80 	1.670000 	2.500000 	;    3.85 	1.650625 	2.475000 	;    3.90 	1.630000 	2.450000 	;    3.95 	1.605000 	2.425000 	;
        4.00 	1.580000 	2.400000 	;    4.05 	1.559375 	2.375000 	;    4.10 	1.540000 	2.350000 	;    4.15 	1.520000 	2.325625 	;
        4.20 	1.500000 	2.300000 	;    4.25 	1.478750 	2.270000 	;    4.30 	1.460000 	2.240000 	;    4.35 	1.448125 	2.214375 	;
        4.40 	1.440000 	2.190000 	;    4.45 	1.436250 	2.165000 	;    4.50 	1.430000 	2.140000 	;    4.55 	1.410000 	2.114375 	;
        4.60 	1.390000 	2.090000 	;    4.65 	1.382500 	2.070000 	;    4.70 	1.380000 	2.050000 	;    4.75 	1.380000 	2.025625 	;
        4.80 	1.380000 	2.000000 	;    4.85 	1.375625 	1.975000 	;    4.90 	1.370000 	1.950000 	;    4.95 	1.364375 	1.925000 	;
        5.00 	1.360000 	1.900000 	;    5.05 	1.358750 	1.874375 	;    5.10 	1.360000 	1.850000 	;    5.15 	1.363750 	1.828750 	;
        5.20 	1.370000 	1.810000 	;    5.25 	1.379375 	1.793750 	;    5.30 	1.390000 	1.780000 	;    5.35 	1.400000 	1.769375 	;
        5.40 	1.410000 	1.760000 	;    5.45 	1.420000 	1.749375 	;    5.50 	1.430000 	1.740000 	;    5.55 	1.440000 	1.734375 	;
        5.60 	1.450000 	1.730000 	;    5.65 	1.461250 	1.724375 	;    5.70 	1.470000 	1.720000 	;    5.75 	1.471875 	1.719375 	;
        5.80 	1.470000 	1.720000 	;    5.85 	1.465000 	1.720625 	;    5.90 	1.460000 	1.720000 	;    5.95 	1.457500 	1.716875 	;
        6.00 	1.460000 	1.710000   ];


data_Cu=[0.50 	1.150000 	13.200000 	;    0.55 	1.005687 	12.013130 	;    0.60 	0.890000 	11.000000 	;    0.65 	0.797563 	10.139380 	;
        0.70 	0.723000 	9.410000 	;    0.75 	0.658438 	8.791875 	;    0.80 	0.606000 	8.260000 	;    0.85 	0.570125 	7.669375 	;
        0.90 	0.536000 	7.360000 	;    0.95 	0.482188 	7.911125 	;    1.00 	0.433000 	8.460000 	;    1.05 	0.414438 	8.116563 	;
        1.10 	0.400000 	7.542000 	;    1.15 	0.364188 	7.146813 	;    1.20 	0.330000 	6.793000 	;    1.25 	0.316250 	6.483250 	;
        1.30 	0.310000 	6.206000 	;    1.35 	0.306250 	5.953374 	;    1.40 	0.300000 	5.717000 	;    1.45 	0.280000 	5.485625 	;
        1.50 	0.260000 	5.260000 	;    1.55 	0.254188 	5.034125 	;    1.60 	0.250000 	4.817000 	;    1.65 	0.236500 	4.619563 	;
        1.70 	0.223000 	4.430000 	;    1.75 	0.216250 	4.239563 	;    1.80 	0.213000 	4.050000 	;    1.85 	0.209250 	3.863125 	;
        1.90 	0.214000 	3.670000 	;    1.95 	0.230813 	3.458187 	;    2.00 	0.272000 	3.240000 	;    2.05 	0.351250 	3.010750 	;
        2.10 	0.468000 	2.809000 	;    2.15 	0.645875 	2.678062 	;    2.20 	0.826000 	2.599000 	;    2.25 	0.950375 	2.576500 	;
        2.30 	1.040000 	2.583000 	;    2.35 	1.092437 	2.595562 	;    2.40 	1.120000 	2.605000 	;    2.45 	1.131562 	2.589625 	;
        2.50 	1.135000 	2.564000 	;    2.55 	1.142812 	2.535875 	;    2.60 	1.150000 	2.504000 	;    2.65 	1.155312 	2.469187 	;
        2.70 	1.160000 	2.433000 	;    2.75 	1.165312 	2.397625 	;    2.80 	1.170000 	2.362000 	;    2.85 	1.172812 	2.326000 	;
        2.90 	1.175000 	2.289000 	;    2.95 	1.178125 	2.249938 	;    3.00 	1.180000 	2.210000 	;    3.05 	1.177500 	2.160063 	;
        3.10 	1.175000 	2.130000 	;    3.15 	1.174375 	2.177188 	;    3.20 	1.180000 	2.210000 	;    3.25 	1.200000 	2.121562 	;
        3.30 	1.225000 	2.015000 	;    3.35 	1.249062 	1.972438 	;    3.40 	1.270000 	1.950000 	;    3.45 	1.281563 	1.931688 	;
        3.50 	1.290000 	1.916000 	;    3.55 	1.300313 	1.894250 	;    3.60 	1.310000 	1.872000 	;    3.65 	1.317812 	1.851750 	;
        3.70 	1.325000 	1.834000 	;    3.75 	1.334375 	1.822125 	;    3.80 	1.340000 	1.810000 	;    3.85 	1.332500 	1.791625 	;
        3.90 	1.325000 	1.770000 	;    3.95 	1.329063 	1.744563 	;    4.00 	1.340000 	1.720000 	;    4.05 	1.358438 	1.703313 	;
        4.10 	1.380000 	1.687000 	;    4.15 	1.400313 	1.662125 	;    4.20 	1.420000 	1.640000 	;    4.25 	1.437813 	1.630875 	;
        4.30 	1.455000 	1.629000 	;    4.35 	1.473750 	1.633312 	;    4.40 	1.490000 	1.640000 	;    4.45 	1.498750 	1.643312 	;
        4.50 	1.505000 	1.648000 	;    4.55 	1.513125 	1.658750 	;    4.60 	1.520000 	1.670000 	;    4.65 	1.523125 	1.675625 	;
        4.70 	1.525000 	1.682000 	;    4.75 	1.529688 	1.693813 	;    4.80 	1.530000 	1.710000 	;    4.85 	1.517187 	1.733812 	;
        4.90 	1.500000 	1.757000 	;    4.95 	1.485938 	1.770250 	;    5.00 	1.470000 	1.780000 	;    5.05 	1.448437 	1.790875 	;
        5.10 	1.425000 	1.799000 	;    5.15 	1.402812 	1.800750 	;    5.20 	1.380000 	1.800000 	;    5.25 	1.355313 	1.800750 	;
        5.30 	1.330000 	1.799000 	;    5.35 	1.305000 	1.790500 	;    5.40 	1.280000 	1.780000 	;    5.45 	1.255000 	1.771750 	;
        5.50 	1.230000 	1.763000 	;    5.55 	1.204375 	1.752375 	;    5.60 	1.180000 	1.740000 	;    5.65 	1.159375 	1.725500 	;
        5.70 	1.140000 	1.709000 	;    5.75 	1.119375 	1.690000 	;    5.80 	1.100000 	1.670000 	;    5.85 	1.084375 	1.650625 	;
        5.90 	1.070000 	1.631000 	;    5.95 	1.054879 	1.610723 	;    6.00 	1.040000 	1.590000 	;    6.05 	1.025607 	1.568884 	;
        6.10 	1.011943 	1.547429 	;    6.15 	0.999250 	1.525687 	;    6.20 	0.987771 	1.503714 	;    6.25 	0.977750 	1.481562 	;
        6.30 	0.969428 	1.459286 	;    6.35 	0.963050 	1.436938 	;    6.40 	0.958857 	1.414571 	;    6.45 	0.957093 	1.392241 	;
        6.50 	0.958000 	1.370000   ];


data_Pt=[0.50 	3.910000 	7.710000 	;    0.55 	4.580000 	7.140000 	;    0.60 	5.130000 	6.750000 	;    0.65 	5.520000 	6.660000 	;
        0.70 	5.710000 	6.830000 	;    0.75 	5.570000 	7.020000 	;    0.80 	5.310000 	7.040000 	;    0.85 	5.050000 	6.980000 	;
        0.90 	4.770000 	6.910000 	;    0.95 	4.500000 	6.770000 	;    1.00 	4.250000 	6.620000 	;    1.05 	4.049131 	6.424542 	;
        1.10 	3.865956 	6.245446 	;    1.15 	3.699681 	6.078740 	;    1.20 	3.549510 	5.920446 	;    1.25 	3.414894 	5.764392 	;
        1.30 	3.294945 	5.607424 	;    1.35 	3.187675 	5.456677 	;    1.40 	3.092579 	5.318040 	;    1.45 	3.005323 	5.187834 	;
        1.50 	2.920452 	5.065721 	;    1.55 	2.838768 	4.950106 	;    1.60 	2.762649 	4.838404 	;    1.65 	2.692612 	4.729439 	;
        1.70 	2.627065 	4.625364 	;    1.75 	2.565715 	4.528474 	;    1.80 	2.506401 	4.435471 	;    1.85 	2.443794 	4.343824 	;
        1.90 	2.383049 	4.253633 	;    1.95 	2.333816 	4.165015 	;    2.00 	2.298639 	4.078156 	;    2.05 	2.267599 	3.994157 	;
        2.10 	2.233199 	3.912901 	;    2.15 	2.198799 	3.837894 	;    2.20 	2.164400 	3.775832 	;    2.25 	2.130000 	3.721094 	;
        2.30 	2.095600 	3.665248 	;    2.35 	2.061200 	3.605152 	;    2.40 	2.026601 	3.544401 	;    2.45 	1.990570 	3.484202 	;
        2.50 	1.957146 	3.424003 	;    2.55 	1.931655 	3.362333 	;    2.60 	1.910870 	3.301998 	;    2.65 	1.890196 	3.247710 	;
        2.70 	1.868365 	3.200178 	;    2.75 	1.847930 	3.154504 	;    2.80 	1.830785 	3.107205 	;    2.85 	1.813714 	3.059905 	;
        2.90 	1.793120 	3.011600 	;    2.95 	1.771340 	2.964253 	;    3.00 	1.751518 	2.921356 	;    3.05 	1.734266 	2.882865 	;
        3.10 	1.717599 	2.843980 	;    3.15 	1.700399 	2.800385 	;    3.20 	1.683199 	2.757659 	;    3.25 	1.665487 	2.720747 	;
        3.30 	1.648290 	2.686901 	;    3.35 	1.632870 	2.653199 	;    3.40 	1.619648 	2.618799 	;    3.45 	1.608390 	2.584399 	;
        3.50 	1.599375 	2.550000 	;    3.55 	1.591284 	2.515600 	;    3.60 	1.583845 	2.480156 	;    3.65 	1.575190 	2.445811 	;
        3.70 	1.561521 	2.415434 	;    3.75 	1.543773 	2.389352 	;    3.80 	1.527929 	2.366163 	;    3.85 	1.518559 	2.345767 	;
        3.90 	1.511001 	2.323449 	;    3.95 	1.503133 	2.291770 	;    4.00 	1.494481 	2.256483 	;    4.05 	1.483260 	2.223016 	;
        4.10 	1.470080 	2.192677 	;    4.15 	1.457790 	2.164337 	;    4.20 	1.448351 	2.138182 	;    4.25 	1.440762 	2.112915 	;
        4.30 	1.436105 	2.086656 	;    4.35 	1.432059 	2.060934 	;    4.40 	1.425735 	2.037464 	;    4.45 	1.417090 	2.016009 	;
        4.50 	1.407835 	1.995164 	;    4.55 	1.398764 	1.974135 	;    4.60 	1.390674 	1.952125 	;    4.65 	1.384910 	1.927238 	;
        4.70 	1.381062 	1.901090 	;    4.75 	1.380234 	1.874609 	;    4.80 	1.380740 	1.848591 	;    4.85 	1.378055 	1.824192 	;
        4.90 	1.369134 	1.802396 	;    4.95 	1.360509 	1.781451 	;    5.00 	1.358720 	1.760001 	;    5.05 	1.359450 	1.738501 	;
        5.10 	1.360000 	1.716597 	;    5.15 	1.360000 	1.694899 	;    5.20 	1.360000 	1.674870 	;    5.25 	1.360000 	1.657403 	;
        5.30 	1.360000 	1.640768 	;    5.35 	1.360000 	1.623600 	;    5.40 	1.360000 	1.606399 	;    5.45 	1.360000 	1.589198 	;
        5.50 	1.360000 	1.571998 	;    5.55 	1.360000 	1.554799 	;    5.60 	1.360000 	1.537599 	;    5.65 	1.360000 	1.520399 	;
        5.70 	1.359424 	1.503199 	;    5.75 	1.359607 	1.485999 	;    5.80 	1.362222 	1.468799 	;    5.85 	1.366657 	1.451600 	;
        5.90 	1.371629 	1.434400 	;    5.95 	1.376341 	1.417200 	;    6.00 	1.380000 	1.400000   ];



%%% check matname %%%
lmatname=lower(matname);
switch lmatname
    case 'ag'
        lset=bp.h*bp.c0./data_Ag(:,1);
        nset=data_Ag(:,2);
        kset=data_Ag(:,3);
    case 'al'
        lset=bp.h*bp.c0./data_Al(:,1);
        nset=data_Al(:,2);
        kset=data_Al(:,3);
    case 'au'
        lset=bp.h*bp.c0./data_Au(:,1);
        nset=data_Au(:,2);
        kset=data_Au(:,3);
    case 'cr'
        lset=bp.h*bp.c0./data_Cr(:,1);
        nset=data_Cr(:,2);
        kset=data_Cr(:,3);
    case 'cu'
        lset=bp.h*bp.c0./data_Cu(:,1);
        nset=data_Cu(:,2);
        kset=data_Cu(:,3);
    case 'pt'
        lset=bp.h*bp.c0./data_Pt(:,1);
        nset=data_Pt(:,2);
        kset=data_Pt(:,3);
end



function [lset nset kset]=fun_nk_palik(bp,matname)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%   nk values of metal - Palik
%%%      - data source: Handbook of Optical Constants of Solids,
%%%                     E. D. Palik (Academic, SanDiego, 1998)
%%%      - matname: 'Ag', 'Au'
%%%      - last updated: 2008. 10. 21. (Ver 1.0), Seyoon Kim
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% metal data %%%
data_Ag=[200.0 	1.072 	1.240 	;    203.3 	1.098 	1.260 	;    206.6 	1.125 	1.270 	;
    213.8 	1.173 	1.290 	;    221.4 	1.208 	1.300 	;    229.6 	1.238 	1.310 	;
    238.4 	1.265 	1.330 	;    248.0 	1.298 	1.350 	;    253.0 	1.320 	1.350 	;
    258.3 	1.343 	1.350 	;    263.8 	1.372 	1.350 	;    269.5 	1.404 	1.330 	;
    275.5 	1.441 	1.310 	;    281.8 	1.476 	1.260 	;    288.3 	1.502 	1.190 	;
    295.2 	1.519 	1.080 	;    298.8 	1.522 	0.992 	;    302.4 	1.496 	0.882 	;
    306.1 	1.432 	0.766 	;    310.0 	1.323 	0.647 	;    311.5 	1.246 	0.586 	;
    313.9 	1.149 	0.540 	;    315.5 	1.044 	0.514 	;    317.9 	0.932 	0.504 	;
    319.5 	0.815 	0.526 	;    322.0 	0.708 	0.565 	;    323.7 	0.616 	0.609 	;
    326.3 	0.526 	0.663 	;    330.6 	0.371 	0.813 	;    332.4 	0.321 	0.902 	;
    335.1 	0.294 	0.986 	;    339.7 	0.259 	1.120 	;    344.4 	0.238 	1.240 	;
    354.2 	0.209 	1.440 	;    364.7 	0.186 	1.610 	;    375.7 	0.200 	1.670 	;
    387.5 	0.192 	1.810 	;    400.0 	0.173 	1.950 	;    413.3 	0.173 	2.110 	;
    427.5 	0.160 	2.260 	;    442.8 	0.157 	2.400 	;    459.2 	0.144 	2.560 	;
    476.9 	0.132 	2.720 	;    495.9 	0.130 	2.880 	;    516.6 	0.130 	3.070 	;
    539.1 	0.129 	3.250 	;    563.6 	0.120 	3.450 	;    590.4 	0.121 	3.660 	;
    619.9 	0.131 	3.880 	;    652.6 	0.140 	4.150 	;    688.8 	0.140 	4.440 	;
    729.3 	0.148 	4.740 	;    774.9 	0.143 	5.090 	;    826.6 	0.145 	5.500 	;
    885.6 	0.163 	5.950 	;    953.7 	0.198 	6.430 	;    1033.0 	0.226 	6.990 	;
    1127.0 	0.251 	7.670 	;    1240.0 	0.329 	8.490 	;    1265.0 	0.375 	7.780 	;
    1291.0 	0.383 	7.920 	;    1305.0 	0.358 	8.950 	;    1319.0 	0.392 	8.060 	;
    1348.0 	0.401 	8.210 	;    1378.0 	0.411 	8.370 	;    1409.0 	0.421 	8.370 	;
    1442.0 	0.431 	8.700 	;    1459.0 	0.446 	10.100 	;    1476.0 	0.442 	8.880 	;
    1512.0 	0.455 	9.080 	;    1550.0 	0.469 	9.320 	;    1590.0 	0.485 	9.570 	;
    1631.0 	0.501 	9.840 	;    1653.0 	0.624 	11.500 	;    1675.0 	0.519 	10.100 	;
    1771.0 	0.557 	10.700 	;    1823.0 	0.578 	11.100 	;    1879.0 	0.600 	11.400 	;
    1907.0 	0.873 	13.300 	;    1937.0 	0.624 	11.800 	;    2000.0 	0.650 	12.200 ];

data_Au=[200.0 	1.427 	1.215 	;    206.6 	1.422 	1.306 	;    213.8 	1.432 	1.364 	;
        217.5 	1.438 	1.388 	;    221.4 	1.442 	1.418 	;    225.4 	1.452 	1.442 	;
        229.6 	1.454 	1.478 	;    233.9 	1.462 	1.510 	;    238.4 	1.470 	1.550 	;
        243.1 	1.478 	1.590 	;    253.0 	1.490 	1.698 	;    258.3 	1.504 	1.748 	;
        263.8 	1.546 	1.784 	;    269.5 	1.598 	1.822 	;    275.5 	1.648 	1.852 	;
        281.8 	1.690 	1.882 	;    288.3 	1.742 	1.900 	;    295.2 	1.776 	1.918 	;
        302.4 	1.812 	1.920 	;    310.0 	1.830 	1.916 	;    317.9 	1.840 	1.904 	;
        326.3 	1.824 	1.878 	;    335.1 	1.798 	1.860 	;    344.4 	1.766 	1.846 	;
        354.2 	1.740 	1.848 	;    364.7 	1.716 	1.862 	;    375.7 	1.696 	1.906 	;
        387.5 	1.674 	1.936 	;    400.0 	1.658 	1.956 	;    413.3 	1.636 	1.958 	;
        427.5 	1.616 	1.940 	;    442.8 	1.562 	1.904 	;    459.2 	1.426 	1.846 	;
        476.9 	1.242 	1.796 	;    495.9 	0.916 	1.840 	;    516.6 	0.608 	2.120 	;
        539.1 	0.402 	2.540 	;    563.6 	0.306 	2.880 	;    590.4 	0.236 	2.970 	;
        619.9 	0.194 	3.060 	;    652.6 	0.166 	3.150 	;    688.8 	0.160 	3.800 	;
        729.3 	0.164 	4.350 	;    774.9 	0.174 	4.860 	;    826.6 	0.188 	5.390 	;
        885.6 	0.210 	5.880 	;    953.7 	0.236 	6.470 	;    1033.0 	0.272 	7.070 	;
        1127.0 	0.312 	7.930 	;    1240.0 	0.372 	8.770 	;    1265.0 	0.389 	8.090 	;
        1291.0 	0.403 	8.250 	;    1319.0 	0.419 	8.420 	;    1384.0 	0.436 	8.590 	;
        1378.0 	0.454 	8.770 	;    1409.0 	0.473 	8.960 	;    1442.0 	0.493 	9.150 	;
        1476.0 	0.515 	9.360 	;    1512.0 	0.537 	9.580 	;    1550.0 	0.559 	9.810 	;
        1590.0 	0.583 	10.100 	;    1631.0 	0.609 	10.300 	;    1675.0 	0.636 	10.600 	;
        1722.0 	0.665 	10.900 	;    1771.0 	0.696 	11.200 	;    1823.0 	0.730 	11.500 	;
        1879.0 	0.767 	11.900 	;    1937.0 	0.807 	12.200 	;    2000.0 	0.850 	12.600 ];



%%% check matname %%%
lmatname=lower(matname);
switch lmatname
    case 'ag'
        lset=data_Ag(:,1)*bp.nm;
        nset=data_Ag(:,2);
        kset=data_Ag(:,3);
    case 'au'
        lset=data_Au(:,1)*bp.nm;
        nset=data_Au(:,2);
        kset=data_Au(:,3);
    otherwise
        error('Invalid material in Palik method');
end



function [lset nset kset]=fun_nk_jnc(bp,matname)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%   nk values of Ag, Au, Cu - J&C
%%%      - data source: P. B. Johnson and R. W. Christy, "Optical Constants
%%%                     of the Noble Metals,"Phys. Rev. B 6, 4370 (1972)
%%%      - matname: 'Ag', 'Au', 'Cu'
%%%      - last updated: 2008. 10. 21. (Ver 1.0), Seyoon Kim
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% metal data %%%
%           eV      n_Cu    k_Cu    n_Ag    k_Ag    n_Au    k_Au
data_metal=[0.640 	0.240 	14.080 	0.920 	13.780 	1.090 	13.430 	;
            0.770 	0.150 	11.850 	0.560 	11.210 	0.760 	11.120 	;
            0.890 	0.130 	10.100 	0.430 	9.519 	0.600 	9.439 	;
            1.020 	0.090 	8.828 	0.350 	8.145 	0.480 	8.245 	;
            1.140 	0.040 	7.795 	0.270 	7.150 	0.360 	7.217 	;
            1.260 	0.040 	6.992 	0.220 	6.350 	0.320 	6.421 	;
            1.390 	0.040 	6.312 	0.170 	5.663 	0.300 	5.768 	;
            1.510 	0.040 	5.727 	0.160 	5.083 	0.260 	5.180 	;
            1.640 	0.030 	5.242 	0.140 	4.542 	0.240 	4.665 	;
            1.760 	0.040 	4.838 	0.130 	4.103 	0.210 	4.205 	;
            1.880 	0.050 	4.483 	0.140 	3.697 	0.220 	3.747 	;
            2.010 	0.060 	4.152 	0.210 	3.272 	0.300 	3.205 	;
            2.130 	0.050 	3.858 	0.290 	2.863 	0.700 	2.704 	;
            2.260 	0.060 	3.586 	0.430 	2.455 	1.020 	2.577 	;
            2.380 	0.050 	3.324 	0.620 	2.081 	1.180 	2.608 	;
            2.500 	0.050 	3.093 	1.040 	1.833 	1.220 	2.564 	;
            2.630 	0.050 	2.869 	1.310 	1.849 	1.250 	2.483 	;
            2.750 	0.040 	2.657 	1.380 	1.914 	1.240 	2.397 	;
            2.880 	0.040 	2.462 	1.450 	1.948 	1.250 	2.305 	;
            3.000 	0.050 	2.275 	1.460 	1.958 	1.280 	2.207 	;
            3.120 	0.050 	2.070 	1.470 	1.952 	1.320 	2.116 	;
            3.250 	0.050 	1.864 	1.460 	1.933 	1.330 	2.045 	;
            3.370 	0.070 	1.657 	1.480 	1.895 	1.360 	1.975 	;
            3.500 	0.100 	1.419 	1.500 	1.866 	1.370 	1.916 	;
            3.620 	0.140 	1.142 	1.480 	1.871 	1.360 	1.864 	;
            3.740 	0.170 	0.829 	1.480 	1.883 	1.340 	1.821 	;
            3.870 	0.810 	0.392 	1.540 	1.898 	1.380 	1.783 	;
            3.990 	1.130 	0.616 	1.530 	1.893 	1.380 	1.729 	;
            4.120 	1.340 	0.964 	1.530 	1.889 	1.400 	1.679 	;
            4.240 	1.390 	1.161 	1.490 	1.878 	1.420 	1.633 	;
            4.360 	1.410 	1.264 	1.470 	1.869 	1.450 	1.633 	;
            4.490 	1.410 	1.331 	1.430 	1.847 	1.460 	1.646 	;
            4.610 	1.380 	1.372 	1.380 	1.803 	1.450 	1.668 	;
            4.740 	1.350 	1.387 	1.350 	1.749 	1.410 	1.691 	;
            4.860 	1.330 	1.393 	1.330 	1.688 	1.410 	1.741 	;
            4.980 	1.310 	1.389 	1.330 	1.631 	1.370 	1.783 	;
            5.110 	1.300 	1.378 	1.320 	1.577 	1.340 	1.799 	;
            5.230 	1.280 	1.367 	1.320 	1.536 	1.280 	1.802 	;
            5.360 	1.280 	1.357 	1.300 	1.497 	1.230 	1.792 	;
            5.480 	1.260 	1.344 	1.310 	1.460 	1.180 	1.768 	;
            5.600 	1.250 	1.342 	1.300 	1.427 	1.130 	1.737 	;
            5.730 	1.220 	1.336 	1.300 	1.387 	1.080 	1.699 	;
            5.850 	1.200 	1.325 	1.300 	1.350 	1.040 	1.651 	;
            5.980 	1.180 	1.312 	1.300 	1.304 	1.010 	1.599 	;
            6.100 	1.150 	1.296 	1.330 	1.277 	0.990 	1.550 	;
            6.220 	1.140 	1.277 	1.330 	1.251 	0.980 	1.493 	;
            6.350 	1.120 	1.255 	1.340 	1.226 	0.970 	1.440 	;
            6.470 	1.100 	1.232 	1.320 	1.203 	0.950 	1.388 	;
            6.600 	1.070 	1.212 	1.280 	1.188 	0.940 	1.337  ];
        

        
%%% check matname %%%
lmatname=lower(matname);
switch lmatname
    case 'ag'
        nset=data_metal(:,2);
        kset=data_metal(:,3);
    case 'au'
        nset=data_metal(:,4);
        kset=data_metal(:,5);
    case 'cu'
        nset=data_metal(:,6);
        kset=data_metal(:,7);
    otherwise
        error('Invalid material in J&C method');
end
lset=bp.h*bp.c0./data_metal(:,1);

