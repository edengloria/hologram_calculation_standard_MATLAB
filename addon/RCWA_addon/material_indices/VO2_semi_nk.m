%%% VO2 n, k 
% - semi mode
% - lambda : 320nm ~ 1000nm
% - Using Lagrange interpolation

function result=VO2_semi_nk(lambda);

lambda=lambda*10^9;

VO2_semi_data_real=[301.68  -1.34741;
304.92  -1.41675;
308.162  -1.4976;
311.94  -1.55547;
317.33  -1.54443;
320.559  -1.47565;
323.246  -1.3838;
325.394  -1.2919;
328.066  -1.01589;
330.755  -0.935551;
331.824  -0.832052;
332.893  -0.728553;
333.962  -0.625054;
335.033  -0.533066;
336.102  -0.429567;
336.632  -0.326021;
337.701  -0.222523;
338.77  -0.119024;
339.3  -0.00396808;
340.369  0.0995308;
340.899  0.203076;
341.428  0.318132;
342.497  0.421631;
343.027  0.525176;
343.557  0.640232;
344.626  0.743731;
345.156  0.847276;
345.685  0.962332;
346.215  1.06588;
346.745  1.18093;
347.814  1.28443;
348.344  1.38798;
348.873  1.50303;
349.403  1.60658;
349.932  1.72163;
350.463  1.82518;
350.992  1.94023;
351.522  2.04378;
352.051  2.15884;
352.581  2.26238;
353.65  2.36588;
354.18  2.48094;
354.71  2.58448;
355.239  2.69954;
355.769  2.80308;
356.298  2.91814;
356.828  3.02168;
357.357  3.13674;
357.878  3.35539;
357.888  3.24028;
358.407  3.47044;
358.937  3.57399;
359.466  3.68904;
359.996  3.79259;
360.525  3.90764;
361.056  4.01119;
361.585  4.12624;
362.115  4.22979;
362.644  4.34485;
363.174  4.44839;
363.703  4.56345;
364.234  4.66699;
364.763  4.78205;
365.293  4.88559;
365.822  5.00065;
366.352  5.10419;
366.881  5.21925;
367.412  5.32279;
367.941  5.43785;
368.471  5.5414;
369.001  5.64494;
369.531  5.74849;
370.06  5.86354;
370.59  5.96709;
371.12  6.08214;
371.65  6.18569;
372.179  6.30074;
372.709  6.40429;
373.238  6.51935;
373.768  6.62289;
374.298  6.73795;
374.828  6.84149;
375.357  6.95655;
376.426  7.06005;
376.956  7.16359;
377.485  7.27865;
378.016  7.38219;
378.545  7.49725;
379.075  7.60079;
380.144  7.70429;
380.673  7.81935;
381.203  7.92289;
381.733  8.03795;
382.263  8.14149;
383.332  8.24499;
383.861  8.36005;
384.93  8.46355;
385.461  8.56709;
386.53  8.67059;
387.059  8.78565;
387.589  8.88919;
388.658  8.99269;
389.187  9.10775;
390.257  9.21125;
391.326  9.31475;
392.395  9.41824;
393.464  9.52174;
394.534  9.62524;
395.603  9.72874;
396.673  9.82073;
397.742  9.92423;
399.352  10.0162;
400.96  10.1196;
402.569  10.2116;
404.178  10.315;
405.787  10.407;
407.935  10.4989;
410.085  10.5792;
412.233  10.6711;
414.922  10.7515;
418.149  10.8318;
422.457  10.8889;
427.306  10.9231;
432.695  10.9456;
437.548  10.9222;
442.941  10.8987;
447.259  10.8408;
451.576  10.7944;
455.893  10.7364;
460.211  10.6785;
464.529  10.6206;
468.846  10.5627;
472.625  10.5048;
476.404  10.4354;
480.182  10.389;
483.962  10.3196;
488.28  10.2502;
492.598  10.1923;
496.377  10.1344;
500.156  10.065;
504.474  10.0071;
508.253  9.93771;
512.571  9.87978;
516.35  9.82191;
520.129  9.75252;
525.524  9.70601;
529.303  9.64814;
533.62  9.59021;
537.938  9.53229;
542.256  9.47437;
547.111  9.42791;
551.428  9.3815;
555.746  9.32357;
560.063  9.26565;
564.381  9.20772;
568.698  9.16131;
573.013  9.12641;
577.33  9.08;
581.647  9.03358;
585.424  8.98722;
589.741  8.9408;
594.057  8.9059;
598.372  8.871;
602.15  8.82463;
607.006  8.77817;
611.859  8.75473;
616.176  8.70832;
621.57  8.67332;
625.886  8.63842;
630.739  8.61498;
635.056  8.56857;
639.911  8.53362;
644.227  8.49871;
649.619  8.47523;
654.474  8.44028;
659.329  8.40533;
664.183  8.38189;
669.576  8.3584;
674.43  8.32346;
679.285  8.28851;
684.678  8.26502;
690.07  8.25304;
694.924  8.2296;
700.316  8.20612;
705.17  8.18268;
710.563  8.15919;
715.417  8.13575;
720.809  8.12378;
726.201  8.1118;
731.054  8.08836;
736.445  8.0879;
741.838  8.06441;
746.692  8.04097;
752.083  8.04051;
757.474  8.04004;
762.866  8.01656;
768.257  8.01609;
773.649  8.00412;
779.041  7.99214;
784.432  7.99168;
789.823  7.99121;
795.214  7.99074;
800.605  7.99028;
805.995  7.98981;
811.386  7.98935;
816.777  7.98888;
822.168  7.98842;
827.559  7.98795;
832.409  8.01055;
837.8  8.01009;
843.191  8.00962;
848.579  8.03218;
853.431  8.03176;
858.82  8.05431;
864.21  8.06536;
869.6  8.0764;
874.451  8.0875;
879.841  8.09854;
885.231  8.09808;
890.62  8.12063;
895.47  8.14323;
900.861  8.14277;
906.25  8.16532;
911.1  8.18792;
916.488  8.22199;
921.878  8.22152;
926.729  8.23261;
932.118  8.25517;
936.967  8.28928;
942.357  8.30033;
947.207  8.32293;
952.596  8.34548;
957.445  8.36808;
962.834  8.39064;
968.224  8.40168;
973.073  8.4358;
978.462  8.45835;
983.312  8.48095;
988.701  8.50351;
993.55  8.52611;
998.939  8.54866;
1003.79  8.58278;
1009.18  8.60533;
1014.03  8.62793;
1019.42  8.65049;
1024.27  8.67309;
1029.65  8.69564;
1034.5  8.71825;
1039.89  8.7408;
1044.74  8.7634;
1050.13  8.77445;
1054.98  8.80856;
1060.37  8.83111;
1065.22  8.85372;
1070.07  8.88783;
1074.92  8.91043;
1080.31  8.93298;
1085.16  8.95559;
1090.55  8.97814;
1095.4  9.00074;
1100.79  9.0233;
1106.17  9.04585;
1111.02  9.05694;
1116.41  9.09101;
1121.26  9.11361;
1126.65  9.11315;
1132.04  9.12419;
1136.89  9.1583;
1142.28  9.16935;
1147.67  9.1919;
1152.52  9.2145;
1157.37  9.23711;
1162.76  9.27117;
1168.15  9.28222;
1173.54  9.28175;
1178.39  9.31586;
1183.78  9.32691;
1188.63  9.338;
1194.02  9.34904;
1199.41  9.3716;
1204.26  9.3942;
1209.65  9.40524;
1215.04  9.41629;
1219.89  9.43889;
1225.28  9.44994;
1230.67  9.46098;
1235.52  9.48358;
1240.91  9.49463;
1246.3  9.50567;
1251.15  9.52827;
1256.54  9.53932;
1261.93  9.55036;
1267.32  9.56141;
1272.17  9.58401;
1277.56  9.59505;
1282.95  9.6061;
1288.33  9.61714;
1293.19  9.61673;
1298.58  9.62777;
1303.97  9.63882;
1309.36  9.66137;
1314.21  9.67246;
1319.6  9.672;
1324.99  9.67153;
1330.38  9.69409;
1335.77  9.70513;
1340.62  9.71622;
1346.01  9.71576;
1351.4  9.73831;
1356.79  9.74936;
1362.18  9.74889;
1367.03  9.75998;
1372.42  9.75952;
1377.81  9.75905;
1383.2  9.78161;
1388.59  9.78114;
1393.98  9.78068;
1398.83  9.80328;
1404.22  9.80281;
1409.61  9.81386;
1415  9.8249;
1420.39  9.82444;
1425.78  9.83548;
1431.17  9.84653;
1436.56  9.84606;
1441.95  9.8456;
1446.8  9.8682;
1452.19  9.86773;
1457.59  9.86727;
1462.98  9.8668;
1468.37  9.88936;
1473.76  9.88889;
1479.15  9.88843;
1484.54  9.88796;
1489.93  9.88749;
1494.78  9.9101;
1500.17  9.90963;
1505.56  9.90917;
1510.95  9.9087;
1516.34  9.91974;
1521.73  9.91928;
1527.12  9.91881;
1532.51  9.91835;
1537.9  9.91788;
1543.3  9.91742;
1548.14  9.95153;
1553.54  9.95106;
1558.93  9.9506;
1564.32  9.95013;
1569.71  9.94967;
1575.1  9.9492;
1580.49  9.94874;
1585.88  9.95978;
1591.27  9.95932;
1596.66  9.95885;
1602.05  9.95839;
1607.44  9.95792;
1612.83  9.95746;
1618.22  9.95699;
1623.62  9.95652;
1628.47  9.97913;
1633.86  9.97866;
1639.25  9.9782;
1644.64  9.97773;
1650.03  9.97726;
1655.42  9.9768;
1660.81  9.97633;
1666.2  9.97587;
1671.59  9.9754;
1676.98  9.97494;
1682.37  9.98598;
1687.76  9.98552;
1693.15  9.98505;
1698.55  9.98459;
1703.94  9.98412;
1709.33  9.98366;
1714.72  9.98319;
1720.11  9.98273;
1725.5  9.98226;
1730.89  9.98179;
1736.28  9.98133;
1741.67  9.98086;
1747.06  9.9804;
1752.45  9.97993;
1757.84  9.99098;
1763.23  10.0135;
1768.62  10.0131;
1774.02  10.0126;
1779.41  10.0121;
1784.8  10.0117;
1790.19  10.0112;
1795.58  10.0107;
1800.97  10.0103;
1806.36  10.0098;
1811.75  10.0093;
1817.14  10.0089;
1822.53  10.0084;
1827.92  10.0079;
1833.31  10.0075;
1838.71  10.007;
1844.1  10.0066;
1849.49  10.0061;
1854.88  10.0056;
1860.27  10.0052;
1865.66  10.0047;
1871.05  10.0042;
1876.44  10.0038;
1881.83  10.0033;
1887.22  10.0028;
1892.61  10.0024;
1898.01  10.0019;
1903.4  10.0014;
1908.79  10.001;
1914.18  10.0005;
1919.57  10;
1924.96  9.99957;
1929.81  10.0107;
1935.2  10.0217;
1940.59  10.0212;
1945.98  10.0208;
1951.37  10.0203;
1956.76  10.0198;
1962.15  10.0194;
1967.55  10.0189;
1972.94  10.0185;
1978.33  10.018;
1983.72  10.0175;
1989.11  10.0171;   
    ];

VO2_semi_data_image = [312.433  5.58228;
313.52  5.66566;
314.067  5.74905;
314.614  5.84171;
315.161  5.9251;
316.248  6.00847;
316.795  6.10113;
317.342  6.18452;
317.889  6.27718;
318.436  6.36057;
318.984  6.45323;
319.53  6.53662;
320.078  6.62928;
320.625  6.71268;
321.172  6.80533;
321.719  6.88873;
322.266  6.98139;
322.813  7.06478;
323.361  7.15744;
323.907  7.24083;
324.455  7.33349;
325.002  7.41688;
325.549  7.50954;
326.096  7.59293;
326.643  7.68559;
327.19  7.76898;
327.738  7.86164;
328.284  7.94503;
328.832  8.03769;
329.379  8.12108;
329.926  8.21374;
330.473  8.29713;
331.02  8.38979;
331.567  8.47318;
332.115  8.56584;
332.661  8.63997;
333.208  8.73263;
333.755  8.81602;
334.302  8.90868;
334.849  8.99207;
335.397  9.08473;
335.943  9.16812;
336.491  9.26078;
337.038  9.34417;
337.585  9.43683;
338.132  9.52022;
338.679  9.61288;
339.226  9.69627;
339.774  9.78893;
340.32  9.87232;
340.868  9.96498;
341.415  10.0484;
341.962  10.141;
342.509  10.2244;
343.056  10.3171;
343.603  10.4005;
344.151  10.4931;
344.697  10.5765;
345.784  10.6599;
346.332  10.7526;
346.878  10.836;
347.426  10.9286;
347.973  11.012;
348.52  11.1047;
349.067  11.1881;
350.154  11.2714;
350.701  11.3641;
351.248  11.4475;
352.335  11.5309;
352.882  11.6235;
353.429  11.7069;
354.516  11.7903;
355.602  11.8736;
356.15  11.9663;
357.237  12.0497;
358.323  12.1331;
359.41  12.2164;
361.036  12.2905;
362.662  12.3646;
363.749  12.448;
365.915  12.522;
369.698  12.5682;
372.933  12.5033;
374.546  12.4198;
376.161  12.3549;
377.774  12.2714;
378.847  12.1879;
379.921  12.1045;
380.994  12.021;
382.067  11.9376;
383.14  11.8542;
384.214  11.7707;
385.287  11.6873;
385.82  11.6038;
386.893  11.5204;
387.967  11.4369;
388.499  11.3442;
389.572  11.2608;
428.115  7.10746;
429.189  7.02401;
430.262  6.94056;
431.335  6.85711;
432.408  6.77367;
433.481  6.69022;
434.555  6.60677;
435.628  6.52332;
436.701  6.43987;
437.774  6.35643;
438.848  6.28225;
439.922  6.1988;
440.995  6.11535;
442.609  6.04115;
443.682  5.9577;
444.755  5.87426;
445.828  5.79081;
447.442  5.70734;
448.515  5.62389;
450.129  5.54969;
451.202  5.46625;
452.815  5.38278;
453.889  5.3086;
455.503  5.2344;
457.117  5.15093;
458.73  5.07674;
460.344  4.99327;
461.958  4.91907;
463.571  4.8356;
465.185  4.7614;
466.799  4.68721;
468.413  4.61301;
470.026  4.52954;
471.64  4.45534;
473.794  4.38112;
475.407  4.29766;
477.562  4.23271;
479.716  4.15849;
481.87  4.08427;
484.024  4.01005;
486.178  3.94511;
488.873  3.88014;
491.027  3.80592;
493.182  3.74097;
495.876  3.66673;
498.571  3.60176;
501.265  3.5368;
503.96  3.47183;
506.655  3.40686;
509.349  3.34189;
512.044  3.27692;
515.279  3.21193;
518.514  3.15621;
521.75  3.1005;
524.984  3.03551;
528.22  2.97979;
531.996  2.93332;
535.771  2.87758;
539.547  2.82184;
543.323  2.77537;
547.64  2.73815;
551.956  2.69166;
555.732  2.64519;
559.509  2.59872;
618.881  2.26301;
624.28  2.25356;
629.679  2.2441;
634.538  2.23467;
639.937  2.22521;
645.336  2.21576;
650.736  2.21557;
656.136  2.21538;
661.536  2.21519;
666.936  2.215;
672.336  2.21482;
677.736  2.21463;
683.136  2.21444;
688.536  2.21425;
693.936  2.22333;
698.798  2.2417;
704.198  2.24151;
709.599  2.25986;
714.999  2.25967;
719.86  2.26877;
725.26  2.27785;
730.662  2.2962;
735.523  2.3053;
740.924  2.32365;
746.325  2.33273;
751.186  2.35109;
756.587  2.36944;
761.449  2.38781;
766.85  2.39689;
772.251  2.41524;
777.112  2.4336;
782.514  2.45195;
787.375  2.47032;
792.777  2.48867;
797.638  2.50703;
803.04  2.52538;
807.901  2.54375;
813.302  2.5621;
818.164  2.58046;
823.565  2.59881;
828.427  2.61718;
833.828  2.63552;
839.229  2.64461;
844.09  2.66297;
849.492  2.69059;
854.354  2.70895;
859.754  2.71803;
864.616  2.7364;
870.018  2.76402;
874.879  2.77312;
880.28  2.79146;
885.142  2.80983;
890.543  2.82818;
895.944  2.84653;
900.806  2.86489;
906.207  2.88324;
911.069  2.90161;
916.469  2.90142;
921.87  2.91977;
926.731  2.93813;
932.131  2.93795;
937.532  2.94703;
942.394  2.97466;
947.794  2.97447;
953.195  2.98355;
958.595  2.99263;
963.457  3.011;
968.857  3.01081;
974.257  3.01989;
979.658  3.02897;
985.058  3.02879;
990.458  3.0286;
995.32  3.05623;
1000.72  3.05605;
1006.12  3.05586;
1011.52  3.05567;
1016.92  3.05548;
1022.32  3.05529;
1027.72  3.06437;
1033.12  3.06419;
1038.52  3.064;
1043.92  3.06381;
1049.32  3.05436;
1054.72  3.05417;
1060.12  3.05398;
1065.52  3.05379;
1070.92  3.05361;
1076.32  3.05342;
1081.18  3.03471;
1086.58  3.02526;
1091.98  3.02507;
1097.38  3.02488;
1102.78  3.01543;
1108.18  3.01524;
1113.03  3.0058;
1118.43  3.00562;
1123.83  2.98689;
1129.23  2.97744;
1134.63  2.96798;
1140.03  2.96779;
1144.89  2.94909;
1150.29  2.93963;
1155.69  2.93018;
1161.09  2.92999;
1165.95  2.91129;
1171.35  2.9111;
1176.74  2.89237;
1181.6  2.87367;
1187  2.87348;
1192.4  2.85476;
1197.8  2.85457;
1202.66  2.83587;
1208.06  2.81714;
1213.46  2.80769;
1218.32  2.79825;
1223.71  2.77953;
1229.11  2.77007;
1233.97  2.76064;
1239.37  2.75118;
1244.77  2.73246;
1249.63  2.72302;
1255.03  2.71356;
1260.43  2.70411;
1265.29  2.6854;
1270.68  2.65741;
1276.08  2.65723;
1280.94  2.63852;
1286.34  2.6198;
1291.74  2.61961;
1296.6  2.61017;
1302  2.59145;
1307.4  2.59126;
1312.26  2.56329;
1317.66  2.55383;
1323.05  2.53511;
1327.91  2.52567;
1333.31  2.50695;
1338.71  2.4975;
1343.57  2.48806;
1348.97  2.4786;
1354.37  2.45988;
1359.23  2.44118;
1364.62  2.43172;
1370.02  2.413;
1374.88  2.40356;
1380.28  2.39411;
1385.68  2.37538;
1391.08  2.37519;
1395.94  2.35649;
1401.34  2.34703;
1406.74  2.33758;
1411.6  2.31887;
1416.99  2.30942;
1422.39  2.29996;
1427.25  2.28126;
1432.65  2.2718;
1438.05  2.26235;
1442.91  2.24364;
1448.31  2.23419;
1453.71  2.234;
1458.57  2.20603;
1463.96  2.19657;
1469.36  2.18712;
1474.76  2.18693;
1479.62  2.16822;
1485.02  2.1495;
1490.42  2.14931;
1495.28  2.13061;
1500.68  2.12115;
1506.08  2.1117;
1511.48  2.10224;
1516.88  2.09279;
1521.73  2.07408;
1527.13  2.07389;
1532.53  2.05517;
1537.39  2.03647;
1542.79  2.03628;
1548.19  2.02682;
1553.59  2.01737;
1558.45  2.00793;
1563.85  1.98921;
1569.25  1.98902;
1574.65  1.97957;
1579.5  1.97013;
1584.9  1.96067;
1590.3  1.94195;
1595.7  1.93249;
1600.56  1.91379;
1605.96  1.9136;
1611.36  1.89488;
1616.76  1.89469;
1621.62  1.87599;
1627.02  1.8758;
1632.42  1.85708;
1637.81  1.85689;
1642.67  1.84745;
1648.07  1.838;
1653.47  1.81927;
1658.87  1.81908;
1663.73  1.80965;
1669.13  1.80946;
1674.53  1.8;
1679.93  1.79055;
1685.33  1.78109;
1690.73  1.77164;
1695.59  1.75293;
1700.99  1.75275;
1706.38  1.74329;
1711.78  1.73384;
1716.64  1.7244;
1722.04  1.72421;
1727.44  1.71476;
1732.84  1.7053;
1738.24  1.69584;
1743.1  1.68641;
1748.5  1.68622;
1753.9  1.6675;
1759.3  1.66731;
1764.7  1.65785;
1769.56  1.64842;
1774.96  1.64823;
1780.35  1.62951;
1785.75  1.62932;
1791.15  1.61059;
1796.55  1.61041;
1801.95  1.61022;
1806.81  1.60078;
1812.21  1.59133;
1817.61  1.5726;
1823.01  1.57242;
1828.41  1.57223;
1833.27  1.56279;
1838.67  1.5626;
1844.07  1.54388;
1849.47  1.53443;
1854.87  1.53424;
1859.73  1.5248;
1865.13  1.52461;
1870.53  1.52443;
1875.92  1.5057;
1881.32  1.49625;
1886.72  1.49606;
1891.58  1.48662;
1896.98  1.48643;
1902.38  1.48625;
1907.78  1.47679;
1913.18  1.4766;
1918.58  1.46715;
1923.44  1.44844;
1928.84  1.44826;
1934.24  1.4388;
1939.64  1.43861;
1945.04  1.43843;
1950.44  1.4197;
1955.84  1.41951;
1961.24  1.41933;
1966.09  1.40062;
1971.49  1.40043;
1976.89  1.40025;
1982.29  1.39079;
1987.69  1.38134;
1993.09  1.38115;
    ];

this_data = VO2_semi_data_real ;
that_data = VO2_semi_data_image ;
if min(lambda) < this_data(1,1) || max(lambda) > this_data(end,1)
    warning(['Out of valid range (' num2str(this_data(1,1)) ' ~ ' num2str(this_data(end,1)) ' nm)']);
end
if min(lambda) < that_data(1,1) || max(lambda) > that_data(end,1)
    warning(['Out of valid range (' num2str(that_data(1,1)) ' ~ ' num2str(that_data(end,1)) ' nm)']);
end
in_range = (this_data(1,1) <= lambda).*(lambda <= this_data(end,1)) ;
in_range2 = (that_data(1,1) <= lambda).*(lambda <= that_data(end,1)) ;
ep_real = in_range.*(interp1(this_data(:,1), this_data(:,2), lambda, 'spline'))+(1-in_range).*(interp1(this_data(:,1), this_data(:,2), lambda, 'linear')) ;
ep_image = in_range.*(interp1(that_data(:,1), that_data(:,2), lambda, 'spline'))+(1-in_range).*(interp1(that_data(:,1), that_data(:,2), lambda, 'linear')) ;

result=sqrt(ep_real+i*ep_image);